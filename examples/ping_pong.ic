-- ::= import "core.ic"
io ::= import "io.ic"

run_demo ::= (max_iters: i64) -> bool {
  iter := 0
  do () ping {
    io.Print("sending...")
  } pong {
    io.Print("received!\n")
    iter += 1
    if (iter >= max_iters) {
      return true
    }
  }
}

do ::= scope [c] () {
  forever () do {
    >> c.ping
    >> c.pong
  }
}

run_demo(10)
